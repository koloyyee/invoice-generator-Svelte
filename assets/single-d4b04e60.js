import{S as me,i as ce,s as de,v as j,w as E,e as C,a as v,x as A,b as w,c as O,d as g,y as h,Z as Ae,A as F,B as $,C as b,g as P,D as k,H as le,_ as he,$ as ke,a2 as qe,a3 as Ce,a0 as $e,ae as Se,T as be,U as ve,n as pe,af as Ne}from"./index-6810098b.js";import{B as R}from"./button-bb4a9d20.js";import{d as Ie,a as Te,e as He,l as ye}from"./index-773fc7e8.js";import{I as Le,C as je,D as Ee,a as Fe,A as Oe,b as Pe,c as Be,d as Je,T as Me,e as Ue}from"./total-amount-0ef51f9e.js";function Ve(e){let n,s,t,i,a,o,p,T,l,S,m,H,I,u,c,_,d,B,y,J,V,Y,q,K,Q,M,W,N,Z,z,se,G,X,U,ie;function oe(f){e[5](f)}let re={};e[0].issuer!==void 0&&(re.issuer=e[0].issuer),l=new Le({props:re}),j.push(()=>E(l,"issuer",oe,e[0].issuer));function ue(f){e[6](f)}let ae={};e[0].customer!==void 0&&(ae.customer=e[0].customer),_=new je({props:ae}),j.push(()=>E(_,"customer",ue,e[0].customer)),y=new Ee({props:{invoiceId:e[0].invoiceId,createdDate:e[0].createdDate,dueDate:e[0].dueDate,status:e[0].status}});function fe(f){e[7](f)}let r={};e[0].items!==void 0&&(r.items=e[0].items),q=new Fe({props:r}),j.push(()=>E(q,"items",fe,e[0].items)),q.$on("setTotalAmount",e[3]);function D(f){e[8](f)}let x={};return e[0].note!==void 0&&(x.note=e[0].note),M=new Oe({props:x}),j.push(()=>E(M,"note",D,e[0].note)),z=new R({props:{type:"submit",text:"Save",class:"secondary "}}),G=new R({props:{type:"submit",text:"Leave",func:e[9],class:"error"}}),{c(){n=C("section"),s=C("form"),t=C("h1"),t.textContent="Create your next invoice",i=v(),a=C("div"),a.innerHTML='<h3 class="font-extrabold">Issue Company Info.</h3>',o=v(),p=C("div"),T=C("section"),A(l.$$.fragment),m=v(),H=C("div"),H.innerHTML='<h3 class="font-extrabold">Customer Company &amp; Invoice Info.</h3>',I=v(),u=C("section"),c=C("div"),A(_.$$.fragment),B=v(),A(y.$$.fragment),J=v(),V=C("div"),V.innerHTML='<h3 class="font-extrabold">Items</h3>',Y=v(),A(q.$$.fragment),Q=v(),A(M.$$.fragment),N=v(),Z=C("div"),A(z.$$.fragment),se=v(),A(G.$$.fragment),w(t,"class","text-center text-4xl font-extrabold mb-2"),w(a,"class","divider"),w(T,"class","issuer-section pb-5"),w(H,"class","divider"),w(c,"class","lg:grid grid-cols-2 gap-2 "),w(V,"class","divider"),w(Z,"class","flex justify-self-end"),w(u,"class","grid issuer-section pb-5"),w(p,"class","invoice-create-form lg:grid grid-col-3"),w(n,"class","not-printable md:grid grdi-cols-3 p-5 m-5 border-2 rounded shadow-md w-50")},m(f,L){O(f,n,L),g(n,s),g(s,t),g(s,i),g(s,a),g(s,o),g(s,p),g(p,T),h(l,T,null),g(p,m),g(p,H),g(p,I),g(p,u),g(u,c),h(_,c,null),g(c,B),h(y,c,null),g(u,J),g(u,V),g(u,Y),h(q,u,null),g(u,Q),h(M,u,null),g(u,N),g(u,Z),h(z,Z,null),g(Z,se),h(G,Z,null),X=!0,U||(ie=Ae(e[1].call(null,s)),U=!0)},p(f,[L]){const ee={};!S&&L&1&&(S=!0,ee.issuer=f[0].issuer,F(()=>S=!1)),l.$set(ee);const te={};!d&&L&1&&(d=!0,te.customer=f[0].customer,F(()=>d=!1)),_.$set(te);const ne={};L&1&&(ne.invoiceId=f[0].invoiceId),L&1&&(ne.createdDate=f[0].createdDate),L&1&&(ne.dueDate=f[0].dueDate),L&1&&(ne.status=f[0].status),y.$set(ne);const _e={};!K&&L&1&&(K=!0,_e.items=f[0].items,F(()=>K=!1)),q.$set(_e);const ge={};!W&&L&1&&(W=!0,ge.note=f[0].note,F(()=>W=!1)),M.$set(ge)},i(f){X||($(l.$$.fragment,f),$(_.$$.fragment,f),$(y.$$.fragment,f),$(q.$$.fragment,f),$(M.$$.fragment,f),$(z.$$.fragment,f),$(G.$$.fragment,f),X=!0)},o(f){b(l.$$.fragment,f),b(_.$$.fragment,f),b(y.$$.fragment,f),b(q.$$.fragment,f),b(M.$$.fragment,f),b(z.$$.fragment,f),b(G.$$.fragment,f),X=!1},d(f){f&&P(n),k(l),k(_),k(y),k(q),k(M),k(z),k(G),U=!1,ie()}}}function Ze(e,n,s){let t,i;le(e,Ie,d=>s(10,i=d));let{invoice:a={}}=n;console.log(a);const o=JSON.parse(localStorage.getItem("appUser")),{form:p,errors:T,data:l,isValid:S}=he({initialValues:{issuer:{_id:o._id,username:o.username??"",email:o.email??"",phone:o.phone??"",website:o.website??"",address:o.address??"",bankName:o.bankName??"",bankAccount:o.bankAccount??"",bankHolder:o.bankHolder??""},customer:{name:"",email:"",address:"",phone:""},invoiceId:new Date().valueOf().toString(),createdDate:new Date().toLocaleDateString(),dueDate:new Date().toLocaleDateString(),note:i,status:Te.NOT_PAID,items:[],totalAmount:0},onSubmit:async d=>{const B=await He();return console.log(B),B},onSuccess:(d,B)=>{ke("Invoice saved!",{icon:"ðŸ§¾",position:"bottom-center",style:"border-radius: 200px;"})},onError(d,B){console.error(d)}});le(e,l,d=>s(0,t=d));function m(d){qe(l,t.totalAmount=d.detail.totalAmount,t),s(4,a.totalAmount=Number(t.totalAmount.toFixed(2)),a)}function H(d){e.$$.not_equal(t.issuer,d)&&(t.issuer=d,l.set(t))}function I(d){e.$$.not_equal(t.customer,d)&&(t.customer=d,l.set(t))}function u(d){e.$$.not_equal(t.items,d)&&(t.items=d,l.set(t))}function c(d){e.$$.not_equal(t.note,d)&&(t.note=d,l.set(t))}const _=()=>Ce("/");return e.$$set=d=>{"invoice"in d&&s(4,a=d.invoice)},[t,p,l,m,a,H,I,u,c,_]}class ze extends me{constructor(n){super(),ce(this,n,Ze,Ve,de,{invoice:4})}}function De(e){let n,s;return{c(){n=C("img"),$e(n.src,s=e[1])||w(n,"src",s),w(n,"alt",e[1])},m(t,i){O(t,n,i)},p(t,i){i&2&&!$e(n.src,s=t[1])&&w(n,"src",s),i&2&&w(n,"alt",t[1])},d(t){t&&P(n)}}}function Ge(e){let n,s,t,i,a,o,p,T,l,S,m,H,I,u,c,_,d,B,y,J,V,Y,q,K,Q;function M(r){e[2](r)}let W={};e[0].issuer!==void 0&&(W.issuer=e[0].issuer),s=new Pe({props:W}),j.push(()=>E(s,"issuer",M,e[0].issuer));let N=e[1]&&De(e);function Z(r){e[3](r)}function z(r){e[4](r)}function se(r){e[5](r)}function G(r){e[6](r)}function X(r){e[7](r)}let U={};e[0].invoiceId!==void 0&&(U.invoiceId=e[0].invoiceId),e[0].createdDate!==void 0&&(U.createdDate=e[0].createdDate),e[0].dueDate!==void 0&&(U.dueDate=e[0].dueDate),e[0].customer!==void 0&&(U.client=e[0].customer),e[0].status!==void 0&&(U.status=e[0].status),l=new Be({props:U}),j.push(()=>E(l,"invoiceId",Z,e[0].invoiceId)),j.push(()=>E(l,"createdDate",z,e[0].createdDate)),j.push(()=>E(l,"dueDate",se,e[0].dueDate)),j.push(()=>E(l,"client",G,e[0].customer)),j.push(()=>E(l,"status",X,e[0].status));function ie(r){e[8](r)}let oe={};e[0].items!==void 0&&(oe.items=e[0].items),_=new Je({props:oe}),j.push(()=>E(_,"items",ie,e[0].items));function re(r){e[9](r)}let ue={};e[0].totalAmount!==void 0&&(ue.totalAmount=e[0].totalAmount),J=new Me({props:ue}),j.push(()=>E(J,"totalAmount",re,e[0].totalAmount));function ae(r){e[10](r)}let fe={};return e[0].note!==void 0&&(fe.note=e[0].note),q=new Ue({props:fe}),j.push(()=>E(q,"note",ae,e[0].note)),{c(){n=C("section"),A(s.$$.fragment),i=v(),a=C("h1"),a.textContent="Invoice",o=v(),p=v(),N&&N.c(),T=v(),A(l.$$.fragment),c=v(),A(_.$$.fragment),B=v(),y=C("div"),A(J.$$.fragment),Y=v(),A(q.$$.fragment),w(a,"class","text-right text-4xl font-extrabold "),w(n,"class","flex justify-between"),w(y,"class","mt-auto")},m(r,D){O(r,n,D),h(s,n,null),g(n,i),g(n,a),g(n,o),g(n,p),N&&N.m(n,null),O(r,T,D),h(l,r,D),O(r,c,D),h(_,r,D),O(r,B,D),O(r,y,D),h(J,y,null),g(y,Y),h(q,y,null),Q=!0},p(r,[D]){const x={};!t&&D&1&&(t=!0,x.issuer=r[0].issuer,F(()=>t=!1)),s.$set(x),r[1]?N?N.p(r,D):(N=De(r),N.c(),N.m(n,null)):N&&(N.d(1),N=null);const f={};!S&&D&1&&(S=!0,f.invoiceId=r[0].invoiceId,F(()=>S=!1)),!m&&D&1&&(m=!0,f.createdDate=r[0].createdDate,F(()=>m=!1)),!H&&D&1&&(H=!0,f.dueDate=r[0].dueDate,F(()=>H=!1)),!I&&D&1&&(I=!0,f.client=r[0].customer,F(()=>I=!1)),!u&&D&1&&(u=!0,f.status=r[0].status,F(()=>u=!1)),l.$set(f);const L={};!d&&D&1&&(d=!0,L.items=r[0].items,F(()=>d=!1)),_.$set(L);const ee={};!V&&D&1&&(V=!0,ee.totalAmount=r[0].totalAmount,F(()=>V=!1)),J.$set(ee);const te={};!K&&D&1&&(K=!0,te.note=r[0].note,F(()=>K=!1)),q.$set(te)},i(r){Q||($(s.$$.fragment,r),$(l.$$.fragment,r),$(_.$$.fragment,r),$(J.$$.fragment,r),$(q.$$.fragment,r),Q=!0)},o(r){b(s.$$.fragment,r),b(l.$$.fragment,r),b(_.$$.fragment,r),b(J.$$.fragment,r),b(q.$$.fragment,r),Q=!1},d(r){r&&P(n),k(s),N&&N.d(),r&&P(T),k(l,r),r&&P(c),k(_,r),r&&P(B),r&&P(y),k(J),k(q)}}}function Ke(e,n,s){let t;le(e,ye,u=>s(1,t=u));let{invoice:i}=n;function a(u){e.$$.not_equal(i.issuer,u)&&(i.issuer=u,s(0,i))}function o(u){e.$$.not_equal(i.invoiceId,u)&&(i.invoiceId=u,s(0,i))}function p(u){e.$$.not_equal(i.createdDate,u)&&(i.createdDate=u,s(0,i))}function T(u){e.$$.not_equal(i.dueDate,u)&&(i.dueDate=u,s(0,i))}function l(u){e.$$.not_equal(i.customer,u)&&(i.customer=u,s(0,i))}function S(u){e.$$.not_equal(i.status,u)&&(i.status=u,s(0,i))}function m(u){e.$$.not_equal(i.items,u)&&(i.items=u,s(0,i))}function H(u){e.$$.not_equal(i.totalAmount,u)&&(i.totalAmount=u,s(0,i))}function I(u){e.$$.not_equal(i.note,u)&&(i.note=u,s(0,i))}return e.$$set=u=>{"invoice"in u&&s(0,i=u.invoice)},[i,t,a,o,p,T,l,S,m,H,I]}class Qe extends me{constructor(n){super(),ce(this,n,Ke,Ge,de,{invoice:0})}}function Re(e){let n,s,t,i,a,o,p,T,l,S,m=e[0]&&we(e);i=new R({props:{func:e[2],text:"Print",class:"success"}});const H=[Xe,We],I=[];function u(c,_){return c[0]?0:1}return o=u(e),p=I[o]=H[o](e),l=new Qe({props:{invoice:e[1]}}),{c(){m&&m.c(),n=v(),s=C("section"),t=C("div"),A(i.$$.fragment),a=v(),p.c(),T=v(),A(l.$$.fragment),w(t,"class","not-printable flex justify-center"),w(s,"class","invoice-preview rounded border-2 shadow-md p-5 m-5 flex flex-col gap-5 ")},m(c,_){m&&m.m(c,_),O(c,n,_),O(c,s,_),g(s,t),h(i,t,null),g(t,a),I[o].m(t,null),g(s,T),h(l,s,null),S=!0},p(c,_){c[0]?m?(m.p(c,_),_&1&&$(m,1)):(m=we(c),m.c(),$(m,1),m.m(n.parentNode,n)):m&&(be(),b(m,1,1,()=>{m=null}),ve());let d=o;o=u(c),o===d?I[o].p(c,_):(be(),b(I[d],1,1,()=>{I[d]=null}),ve(),p=I[o],p?p.p(c,_):(p=I[o]=H[o](c),p.c()),$(p,1),p.m(t,null))},i(c){S||($(m),$(i.$$.fragment,c),$(p),$(l.$$.fragment,c),S=!0)},o(c){b(m),b(i.$$.fragment,c),b(p),b(l.$$.fragment,c),S=!1},d(c){m&&m.d(c),c&&P(n),c&&P(s),k(i),I[o].d(),k(l)}}}function we(e){let n,s;return n=new ze({props:{invoice:e[1]}}),{c(){A(n.$$.fragment)},m(t,i){h(n,t,i),s=!0},p:pe,i(t){s||($(n.$$.fragment,t),s=!0)},o(t){b(n.$$.fragment,t),s=!1},d(t){k(n,t)}}}function We(e){let n,s;return n=new R({props:{func:e[4],text:"Edit",class:"secondary"}}),{c(){A(n.$$.fragment)},m(t,i){h(n,t,i),s=!0},p:pe,i(t){s||($(n.$$.fragment,t),s=!0)},o(t){b(n.$$.fragment,t),s=!1},d(t){k(n,t)}}}function Xe(e){let n,s,t,i;return n=new R({props:{func:e[5],text:"Update",class:"primary"}}),t=new R({props:{func:e[4],text:"Cancel",class:"error"}}),{c(){A(n.$$.fragment),s=v(),A(t.$$.fragment)},m(a,o){h(n,a,o),O(a,s,o),h(t,a,o),i=!0},p:pe,i(a){i||($(n.$$.fragment,a),$(t.$$.fragment,a),i=!0)},o(a){b(n.$$.fragment,a),b(t.$$.fragment,a),i=!1},d(a){k(n,a),a&&P(s),k(t,a)}}}function Ye(e){let n,s,t,i,a=e[1]&&Re(e);return t=new R({props:{func:e[3],text:"Back",class:"warning justify-self-end"}}),{c(){n=C("div"),a&&a.c(),s=v(),A(t.$$.fragment),w(n,"class","sm:grid lg:grid grid-cols-2 ")},m(o,p){O(o,n,p),a&&a.m(n,null),O(o,s,p),h(t,o,p),i=!0},p(o,[p]){o[1]&&a.p(o,p)},i(o){i||($(a),$(t.$$.fragment,o),i=!0)},o(o){b(a),b(t.$$.fragment,o),i=!1},d(o){o&&P(n),a&&a.d(),o&&P(s),k(t,o)}}}function xe(e,n,s){let t=JSON.parse(localStorage.getItem("invoices")),i=!1,{params:a={invoiceId:""}}=n,o=t.find(m=>m._id===a.invoiceId);const p=()=>{window.print()},T=()=>{Ne()},l=()=>{s(0,i=!i)},S=async()=>{if(!(o.issuer.username===""||o.issuer.email===""||o.issuer.bankName===""||o.issuer.bankHolder===""||o.issuer.bankAccount===""||o.issuer.address===""||o.customer.name===""||o.customer.address===""||o.items.length===0||o.totalAmount===0)){Ie.set(o.note);try{const m=await fetch(`https://api.loyyee.co/invoice-generator/invoices/${o._id}`,{method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify(o)});console.log(m.status)}catch(m){console.log(m.message)}s(0,i=!1)}};return Se("invoiceData",{invoice:o}),e.$$set=m=>{"params"in m&&s(6,a=m.params)},[i,o,p,T,l,S,a]}class it extends me{constructor(n){super(),ce(this,n,xe,Ye,de,{params:6})}}export{it as default};
